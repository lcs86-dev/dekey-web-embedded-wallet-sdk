!function(e){function t(t){for(var r,a,i=t[0],c=t[1],u=t[2],p=0,l=[];p<i.length;p++)a=i[p],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&l.push(o[a][0]),o[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(d&&d(t);l.length;)l.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(r=!1)}r&&(s.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={0:0},s=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var d=c;s.push([635,1]),n()}({281:function(e,t,n){var r=n(432),o=[];e.exports=function(){var e=new Worker(n.p+"41b609b90a116a1c1bba.worker.js",{name:"[hash].worker.js"});return r(e,o),e}},282:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return P}));var r=n(8),o=n.n(r),s=n(19),a=n.n(s),i=n(18),c=n.n(i),u=n(9),d=n.n(u),p=n(30),l=n.n(p),m=n(32),h=n.n(m),f=n(21),v=n.n(f),g=n(7),b=n.n(g),w=n(3),_=n.n(w),y=n(57),k=n(15),S=n.n(k),E=n(31),x=n(29),O=n.n(x);function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var o=v()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var P=function(t){l()(s,t);var n,r=A(s);function s(t){var n,o=t.mpcService,i=t.dekeyStore,c=t.accountRestApi;return a()(this,s),n=r.call(this),b()(d()(n),"calculateV",(function(e){var t=e.r,n=e.s,r=e.hash,o=e.addressInUse,s=e.vsource,a=e.chainId;try{var i=s+35+2*a;if(y.a.utils.recoverAddress(r,{v:i,r:t,s:n})!==o)throw new Error("Recovered address is not equalt to addressInUse");return i}catch(e){throw e}})),b()(d()(n),"concatSig",(function(t,r,o){var s=e.from(Object(E.stripHexPrefix)(r),"hex"),a=e.from(Object(E.stripHexPrefix)(o),"hex"),i=O.a.fromSigned(s),c=O.a.fromSigned(a),u=n._padWithZeroes(O.a.toUnsigned(i).toString("hex"),64),d=n._padWithZeroes(O.a.toUnsigned(c).toString("hex"),64),p=O.a.stripHexPrefix(O.a.intToHex(t+27));return O.a.addHexPrefix(u.concat(d,p)).toString("hex")})),b()(d()(n),"_padWithZeroes",(function(e,t){for(var n="".concat(e);n.length<t;)n="0".concat(n);return n})),b()(d()(n),"serializeEthTx",(function(e){return y.a.utils.serializeTransaction(e)})),n.mpcService=o,n.dekeyStore=i,n.accountRestApi=c,n}return c()(s,[{key:"signTx",value:(n=o()(_.a.mark((function e(t){var n,r,o,s,a,i,c,u,d,p,l,m,h,f,v,g,b;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.txParams,r=t.network,o=t.nonce,s=t.account,e.prev=1,a=r.chainId,i=this.makeUnsignedTx({to:n.to,value:n.value,data:n.data,gasLimit:n.gasLimit,gasPrice:n.gasPrice,maxFeePerGas:n.maxFeePerGas,maxPriorityFeePerGas:n.maxPriorityFeePerGas,chainId:a,nonce:o}),console.log("unsignedTx",i),n.contractAddress&&delete i.value,n.gasPrice,n.to,c=this.dekeyStore.getState(),u=c.accessToken,d=this.serializeEthTx(i),p=y.a.utils.keccak256(d),e.next=12,this.accountRestApi.getMpcJwt(u);case 12:return l=e.sent,e.next=15,this.mpcService.sign({txHash:p.slice(2),mpcToken:l,accountId:s.id});case 15:if(m=e.sent,console.log("sResult",m),h=m.r,f=m.s,v=m.vsource,g=this.calculateV({r:h,s:f,vsource:v,hash:p,addressInUse:s.ethAddress,chainId:a}),b=y.a.utils.serializeTransaction(i,{v:g,r:h,s:f})){e.next=22;break}throw new Error("No rawTx");case 22:return e.abrupt("return",b);case 25:throw e.prev=25,e.t0=e.catch(1),e.t0;case 28:case"end":return e.stop()}}),e,this,[[1,25]])}))),function(e){return n.apply(this,arguments)})},{key:"makeUnsignedTx",value:function(e){var t=e.to,n=e.value,r=e.data,o=e.gasLimit,s=e.gasPrice,a=e.maxFeePerGas,i=e.maxPriorityFeePerGas,c=e.chainId,u=e.nonce;return Boolean(a)?{chainId:c,data:r,to:t,value:n,nonce:u,gasLimit:o,maxFeePerGas:a,maxPriorityFeePerGas:i,type:2}:{chainId:c,data:r,to:t,value:n,nonce:u,gasLimit:o,gasPrice:s}}}]),s}(S.a)}).call(this,n(4).Buffer)},289:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return R}));var r=n(8),o=n.n(r),s=n(19),a=n.n(s),i=n(18),c=n.n(i),u=n(9),d=n.n(u),p=n(30),l=n.n(p),m=n(32),h=n.n(m),f=n(21),v=n.n(f),g=n(7),b=n.n(g),w=n(3),_=n.n(w),y=n(15),k=n.n(y),S=n(29),E=n.n(S),x=n(55),O=n(637),A=n(41);function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var o=v()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h()(this,n)}}var T=n(159),M=/^[0-9A-Fa-f]+$/g,R=function(t){l()(h,t);var n,r,s,i,u,p,m=P(h);function h(e){var t,n=e.mpcService,r=e.transactionService,o=e.dekeyStore,s=e.getMpcJwt;return a()(this,h),t=m.call(this),b()(d()(t),"messages",void 0),b()(d()(t),"mpcService",void 0),b()(d()(t),"transactionService",void 0),b()(d()(t),"dekeyStore",void 0),b()(d()(t),"getMpcJwt",void 0),b()(d()(t),"_addHexPrefix",(function(e){return"string"!=typeof e||e.match(/^\x2D?0x/)?e:e.match(/^\x2D?0X/)?e.replace("0X","0x"):e.startsWith("-")?e.replace("-","-0x"):"0x".concat(e)})),t.messages=[],t.mpcService=n,t.transactionService=r,t.dekeyStore=o,t.getMpcJwt=s,t}return c()(h,[{key:"unapprovedPersonalMsgCount",get:function(){return Object.keys(this.getUnapprovedMsgs()).length}},{key:"getUnapprovedMsgs",value:function(){return this.messages.filter((function(e){return"unapproved"===e.status})).reduce((function(e,t){return e[t.id]=t,e}),{})}},{key:"addUnapprovedMessageAsync",value:function(e,t){var n=this;return new Promise(function(){var t=o()(_.a.mark((function t(r,o){var s,a,i,c;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=n.dekeyStore.getState(),a=s.user,i=A.a.getActiveAccount(a.accounts),"personal_sign"!==e.method){t.next=8;break}if(e.params[1].toLowerCase()===i.ethAddress.toLowerCase()){t.next=6;break}return o(x.ethErrors.provider.userRejectedRequest("Dekey Message Signature: Address mismatch.")),t.abrupt("return");case 6:t.next=11;break;case 8:if(e.params[0].toLowerCase()===i.ethAddress.toLowerCase()){t.next=11;break}return o(x.ethErrors.provider.userRejectedRequest("Dekey Message Signature: Address mismatch.")),t.abrupt("return");case 11:return t.next=13,n.addUnapprovedMessage(e);case 13:c=t.sent,n.once("".concat(c,":finished"),(function(e){switch(e.status){case"signed":return r(e.rawSig);case"rejected":return o(x.ethErrors.provider.userRejectedRequest("Dekey Message Signature: User denied message signature."));default:o(new Error("Dekey Message Signature: Unknown problem"))}}));case 15:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"addUnapprovedMessage",value:(p=o()(_.a.mark((function e(t){var n,r,o,s;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getMsgParams(t),t&&(n.origin=t.domainName),n.data=this.normalizeMsgData(n.data),r=(new Date).getTime(),o=Object(O.a)(),s={id:o,msgParams:n,time:r,status:"unapproved",type:t.method},e.next=8,this.addMsg(s);case 8:return this.signPersonalMessage(o),e.abrupt("return",o);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"getMsgParams",value:function(e){if("personal_sign"===e.method||"klay_sign"===e.method){var t,n,r=e.params[0],o=e.params[1],s=e.params[2]||{};if(C(r)&&!C(o)){"[message, address]. This was previously handled incorrectly, ","and has been corrected automatically. ","Please switch this param order for smooth behavior in the future.",t=r,n=o}else n=r,t=o;return Object.assign({},s,{from:t,data:n})}if("eth_sign"===e.method){var a=e.params[0],i=e.params[1],c=e.params[2]||{};return Object.assign({},c,{from:a,data:i})}}},{key:"signPersonalMessage",value:function(e){var t=this,n=this.dekeyStore.getState().unapprovedPersonalMsgs[e];if(!n)throw new Error("No msgParams for personal sign");return this.approveMessage(n).then(function(){var e=o()(_.a.mark((function e(n){var r,o,s,a,i,c,u,d,p,l,m,h,f;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.dekeyStore.getState(),o=r.user,s=r.accessToken,a=A.a.getActiveAccount(o.accounts),n.msgParams.from.toLowerCase()===a.ethAddress.toLowerCase()){e.next=4;break}return e.abrupt("return");case 4:return i=n.msgParams.data,c=E.a.hashPersonalMessage(E.a.toBuffer(i)),c=E.a.bufferToHex(c),e.next=9,t.getMpcJwt(s);case 9:return u=e.sent,e.prev=10,e.next=13,t.mpcService.sign({accountId:a.id,mpcToken:u,txHash:c});case 13:return d=e.sent,p=d.r,l=d.s,m=d.vsource,h=t.transactionService.concatSig(m,p,l),f=E.a.bufferToHex(h),e.abrupt("return",f);case 22:e.prev=22,e.t0=e.catch(10),console.error(e.t0);case 25:case"end":return e.stop()}}),e,null,[[10,22]])})));return function(t){return e.apply(this,arguments)}}()).then((function(n){return t.setMsgStatusSigned(e,n),n})).catch((function(e){}))}},{key:"personalRecover",value:(u=o()(_.a.mark((function e(t,n){var r,o,s,a,i;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.params[0],o=t.params[1],s=t.params[2]||{},a=Object.assign({},s,{sig:o,data:r}),i=T.recoverPersonalSignature(a),e.abrupt("return",i);case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),function(e,t){return u.apply(this,arguments)})},{key:"addMsg",value:(i=o()(_.a.mark((function e(t){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.messages.push(t),e.next=3,this._saveMsgList();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getMsg",value:function(e){return this.messages.find((function(t){return t.id===e}))}},{key:"approveMessage",value:(s=o()(_.a.mark((function e(t){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.setMsgStatusApproved(t.id),e.abrupt("return",this.prepMsgForSigning(t));case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e){return s.apply(this,arguments)})},{key:"setMsgStatusApproved",value:function(e){this._setMsgStatus(e,"approved")}},{key:"setMsgStatusSigned",value:function(e,t){var n=this.getMsg(e);n.rawSig=t,this._updateMsg(n),this._setMsgStatus(e,"signed")}},{key:"prepMsgForSigning",value:function(e){return delete e.id,Promise.resolve(e)}},{key:"rejectMsg",value:function(e){this._setMsgStatus(e,"rejected")}},{key:"_setMsgStatus",value:function(e,t){var n=this.getMsg(e);if(!n)throw new Error('PersonalMessageManager - Message not found for id: "'.concat(e,'".'));n.status=t,this._updateMsg(n),this.emit("".concat(e,":").concat(t),n),"rejected"!==t&&"signed"!==t||this.emit("".concat(e,":finished"),n)}},{key:"_updateMsg",value:(r=o()(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return-1!==(n=this.messages.findIndex((function(e){return e.id===t.id})))&&(this.messages[n]=t),e.next=4,this._saveMsgList();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"_saveMsgList",value:(n=o()(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.getUnapprovedMsgs(),Object.keys(t).length,this.dekeyStore.updateStore({unapprovedPersonalMsgs:t}),this.emit("updateBadge");case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"normalizeMsgData",value:function(t){try{var n=E.a.stripHexPrefix(t);if(n.match(M))return this._addHexPrefix(n)}catch(e){}return E.a.bufferToHex(e.from(t,"utf8"))}}]),h}(k.a);function C(e){return 42===e.length}}).call(this,n(4).Buffer)},314:function(e,t){},315:function(e,t){},325:function(e,t){},327:function(e,t){},339:function(e,t){},340:function(e,t){},364:function(e,t){},366:function(e,t){},368:function(e,t){},377:function(e,t){},379:function(e,t){},399:function(e,t){},401:function(e,t){},408:function(e,t){},41:function(e,t,n){"use strict";var r={getActiveAccount:function(e){return e.find((function(e){return 0===e.id}))},getSid:function(e){return e[0].sid}};t.a=r},410:function(e,t){},413:function(e,t){},415:function(e,t){},417:function(e,t){},464:function(e,t){},466:function(e,t){},549:function(e,t){},551:function(e,t){},558:function(e,t){},559:function(e,t){},635:function(e,t,n){"use strict";n.r(t);var r=n(8),o=n.n(r),s=n(3),a=n.n(s),i=n(18),c=n.n(i),u=n(19),d=n.n(u),p=n(9),l=n.n(p),m=n(30),h=n.n(m),f=n(32),v=n.n(f),g=n(21),b=n.n(g),w=n(7),_=n.n(w),y=n(278),k=n.n(y),S=n(23),E=n(56),x=("\n\t(function () {\n\t\t".concat("\n\tconst shortcutIcon = window.document.querySelector('head > link[rel=\"shortcut icon\"]');\n\tconst icon = shortcutIcon || Array.from(window.document.querySelectorAll('head > link[rel=\"icon\"]')).find((icon) => Boolean(icon.href));\n\n\tconst siteName = document.querySelector('head > meta[property=\"og:site_name\"]');\n\tconst title = siteName || document.querySelector('head > meta[name=\"title\"]');\n\twindow.ReactNativeWebView && window.ReactNativeWebView.postMessage(JSON.stringify(\n\t\t{\n\t\t\ttype: 'GET_TITLE_FOR_BOOKMARK',\n\t\t\tpayload: {\n\t\t\t\ttitle: title ? title.content : document.title,\n\t\t\t\turl: location.href,\n\t\t\t\ticon: icon && icon.href\n\t\t\t}\n\t\t}\n\t))\n","\n\t})();\n"),"\n\t(function () {\n\t\t".concat('\n\tconst __getFavicon = function(){\n\t\tlet favicon = undefined;\n\t\tconst nodeList = document.getElementsByTagName("link");\n\t\tfor (let i = 0; i < nodeList.length; i++)\n\t\t{\n\t\t\tconst rel = nodeList[i].getAttribute("rel")\n\t\t\tif (rel === "icon" || rel === "shortcut icon")\n\t\t\t{\n\t\t\t\tfavicon = nodeList[i]\n\t\t\t}\n\t\t}\n\t\treturn favicon && favicon.href\n\t}\n\twindow.ReactNativeWebView && window.ReactNativeWebView.postMessage(JSON.stringify(\n\t\t{\n\t\t\ttype: \'GET_WEBVIEW_URL\',\n\t\t\tpayload: {\n\t\t\t\turl: location.href,\n\t\t\t\ticon: __getFavicon()\n\t\t\t}\n\t\t}\n\t))\n',"\n\t})();\n"),n(4)),O=n(279);function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var o=b()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v()(this,n)}}var P=function(){},T=function(e){h()(n,e);var t=A(n);function n(e,r){var o;return d()(this,n),o=t.call(this,{objectMode:!0}),_()(l()(o),"_onMessage",(function(e){if(x.Buffer.isBuffer(e)){delete e._isBuffer;var t=new x.Buffer(e);this.push(t)}else this.push(e)})),_()(l()(o),"_onDisconnect",(function(){this.destroy&&this.destroy()})),_()(l()(o),"_read",P),_()(l()(o),"_write",(function(e,t,n){try{if(x.Buffer.isBuffer(e)){var r=e.toJSON();r._isBuffer=!0,this._port.postMessage(r,this._url)}else this._port.postMessage(e,this._url)}catch(e){return n(new Error("PortDuplexStream - disconnected"))}n()})),o._port=e,o._url=r,o._port.addListener("message",o._onMessage.bind(l()(o))),o._port.addListener("disconnect",o._onDisconnect.bind(l()(o))),o}return c()(n)}(O.Duplex),M=(n(397),n(406)),R=n(201);var C=n(280),D=n(41);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var o=b()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v()(this,n)}}var L=n(208),N=n(427),j=n(201),V=n(15).EventEmitter,H=function(e){h()(n,e);var t=I(n);function n(e,r){var o;return d()(this,n),o=t.call(this),_()(l()(o),"postMessage",(function(e){window.parent.postMessage(JSON.stringify(e),"*")})),o._window=e,o._isMainFrame=r,o}return c()(n)}(V);var G=function(e){h()(n,e);var t=I(n);function n(e){var r,o=e.webview,s=e.url,a=e.isMainFrame,i=e.transactionController,c=e.personalMessageController,u=e.accountController,p=e.providerConnectionManager,m=e.dekeyStore;d()(this,n),r=t.call(this),_()(l()(r),"sendStateUpdate",(function(){r.emit("update")})),_()(l()(r),"onMessage",(function(e){r.port.emit("message",{name:e.name,data:e.data})})),_()(l()(r),"onDisconnect",(function(){r.port.emit("disconnect",{name:r.port.name,data:null})})),r.url=s,r.hostname=new k.a(s).hostname,r.isMainFrame=a,r._webviewRef=o,r.transactionController=i,r.personalMessageController=c,r.accountController=u,r.providerConnectionManager=p,r.dekeyStore=m,r.port=new H(r._webviewRef,a),r.engine=null,r.chainIdSent=null;var h=function(e){var t=new M;return R(e,t,e,(function(e){e&&console.warn(e)})),t}(new T(r.port,s));r.setupProviderConnection(h.createStream("dekey-mobile-provider")),r.on("update",r.onStateUpdate),window.addEventListener("message",(function(e){var t=e.data;try{t=JSON.parse(e.data)}catch(e){}r.onMessage(t)}));var f=r.dekeyStore.getState(),v=f.encpv,g=f.locked,b=!!v;return window.parent.postMessage({type:"bridge#initialized",hasKeyShare:b,locked:g},"*"),r}return c()(n,[{key:"onStateUpdate",value:function(e){e||(e=this.getState());var t=this.getProviderNetworkState(e);this.chainIdSent!==t.chainId&&(this.chainIdSent=t.chainId)}},{key:"getProviderState",value:function(){var e=this.getState();return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({isUnlocked:this.isUnlocked()},this.getProviderNetworkState(e))}},{key:"setupProviderConnection",value:function(e){var t=this;try{this.engine=this.setupProviderEngine();var n=Object(C.createEngineStream)({engine:this.engine});j(e,n,e,(function(e){t.engine._middleware.forEach((function(e){e.destroy&&"function"==typeof e.destroy&&e.destroy()}))}))}catch(e){console.error(e)}}},{key:"setupProviderEngine",value:function(){var e=new S.JsonRpcEngine,t=this.providerConnectionManager.getProviderAndBlockTracker(),n=t.provider,r=t.blockTracker,s=L({provider:n,blockTracker:r}),i=N({provider:n,blockTracker:r});return i.events.on("notification",(function(t){return e.emit("notification",t)})),e.push((origin,function(e,t,n){n((function(e){e()}))})),e.push(s),e.push(i.middleware),e.push(function(e){e.hostname,e.getProviderState;var t=e.ethSendTransaction,n=(e.resetStore,e.getStoreState),r=e.updateStore,s=e.dekeyGenerateKey,i=e.dekeyRecoverShare,c=(e.retrieveKeyShare,e.unlock),u=e.addUnapprovedMessageAsync,d=(e.dekeyHandleSavingRecoverInfoFailure,e.signPersonalMessage,e.getUser),p=e.changePassword;return Object(S.createAsyncMiddleware)(function(){var e=o()(a.a.mark((function e(l,m,h){var f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((f={personal_sign:function(){var e=o()(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u(l);case 3:t=e.sent,m.result=t,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),m.error=e.t0.toString();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),eth_requestAccounts:function(){var e=o()(a.a.mark((function e(){var t,r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n(),(r=t.user)?(o=D.a.getActiveAccount(r.accounts),m.result=o?[o.ethAddress]:[]):m.result=[];case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),eth_accounts:function(){var e=o()(a.a.mark((function e(){var t,r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n(),(r=t.user)?(o=D.a.getActiveAccount(r.accounts),m.result=o?[o.ethAddress]:[]):m.result=[];case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),eth_sendTransaction:function(){var e=o()(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(l.params[0]);case 3:n=e.sent,console.log("ethSendTransaction txHash",n),m.result=n,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),m.error=e.t0.toString();case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),dekey_wallet_create:function(){var e=o()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s(l.params[0]);case 3:m.result=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),m.error=e.t0.toString();case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),dekey_wallet_recover:function(){var e=o()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i(l.params[0]);case 3:m.result=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),m.error=e.t0.toString();case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),dekey_handle_saving_recover_info_failure:function(){var e=o()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{r({user:null}),m.result=!0}catch(e){m.error=e.toString()}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),dekey_update_store:function(){try{r(l.params[0]),m.result=!0}catch(e){m.error=e.toString()}},dekey_unlock:function(){var e=o()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c(l.params[0]);case 3:m.result=!0,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),m.error=e.t0.toString();case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),dekey_user:function(){var e=o()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d();case 3:m.result=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),m.error=e.t0.toString();case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),dekey_change_password:function(){var e=o()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p({oldAessource:l.params[0],newAessource:l.params[1],EncPV:l.params[2]});case 3:m.result=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),m.error=e.t0.toString();case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),metamask_getProviderState:function(){var e=o()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.result={isUnlocked:!0,networkVersion:"1",chainId:"0x1",accounts:[]};case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),metamask_logWeb3ShimUsage:function(){return m.result=null}})[l.method]){e.next=3;break}return e.abrupt("return",h());case 3:return e.next=5,f[l.method]();case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}())}({hostname:this.hostname,getProviderState:function(){},ethSendTransaction:this.transactionController.ethSendTransaction.bind(this.transactionController),addUnapprovedMessageAsync:this.personalMessageController.addUnapprovedMessageAsync.bind(this.personalMessageController),signPersonalMessage:this.personalMessageController.signPersonalMessage.bind(this.personalMessageController),resetStore:this.dekeyStore.reset.bind(this.dekeyStore),getStoreState:this.dekeyStore.getState.bind(this.dekeyStore),updateStore:this.dekeyStore.updateStore.bind(this.dekeyStore),dekeyGenerateKey:this.accountController.generateKey.bind(this.accountController),dekeyRecoverShare:this.accountController.recoverShare.bind(this.accountController),unlock:this.accountController.unlock.bind(this.accountController),getUser:this.accountController.getUser.bind(this.accountController),changePassword:this.accountController.changePassword.bind(this.accountController)})),e.push(Object(E.providerAsMiddleware)(n)),e}},{key:"sendNotification",value:function(e){this.engine&&this.engine.emit("notification",e)}}]),n}(V),F=n(15),J=n.n(F),K=n(637),B=n(149),W=n.n(B),z={getWallet:function(e){var t=e.map((function(e){return e.wid})),n=Math.max.apply(Math,W()(t));return e.find((function(e){return e.wid==n}))},getNextWidForRecover:function(e){var t=e.map((function(e){return e.wid}));return Math.max.apply(Math,W()(t))+1}};function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var o=b()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v()(this,n)}}Object(K.a)();var q=function(e){h()(n,e);var t=X(n);function n(e){var r,s=e.accountRestApi,i=e.dekeyStore;return d()(this,n),r=t.call(this),_()(l()(r),"_autologinTimeout",void 0),_()(l()(r),"registerUser",function(){var e=o()(a.a.mark((function e(t){var n,o,s,i,c,u,d,p,l,m,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.address,o=t.pubkey,s=t.uCPubKey,i=t.sid,c=t.uid,u=t.wid,console.log("registerUser",{address:n,pubkey:o,uCPubKey:s,sid:i,uid:c,wid:u}),e.prev=2,e.next=5,r.accountRestApi.registerUser({address:n,pubkey:o,uCPubKey:s,sid:i,uid:c,wid:u});case 5:return d=e.sent,p=d.accessToken,l=d.user,m=d.wallets,h=d.expiresIn,r.dekeyStore.updateStore({accessToken:p,expirationTime:(new Date).getTime()+ +h}),e.abrupt("return",{user:l,wallets:m});case 14:throw e.prev=14,e.t0=e.catch(2),e.t0;case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t){return e.apply(this,arguments)}}()),_()(l()(r),"recoverWallet",function(){var e=o()(a.a.mark((function e(t){var n,o,s,i,c,u,d,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uCPubKey,o=t.uid,s=t.wid,e.prev=1,e.next=4,r.accountRestApi.recoverWallet({uCPubKey:n,uid:o,wid:s});case 4:return i=e.sent,c=i.accessToken,u=i.user,d=i.expiresIn,p=i.wallets,r.dekeyStore.updateStore({accessToken:c,expirationTime:(new Date).getTime()+ +d}),e.abrupt("return",{user:u,wallets:p});case 13:throw e.prev=13,e.t0=e.catch(1),e.t0;case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}()),_()(l()(r),"getUser",o()(a.a.mark((function e(){var t,n,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.dekeyStore.getState(),n=t.accessToken,e.next=4,r.accountRestApi.getUser(n);case 4:return o=e.sent,e.abrupt("return",o);case 8:e.prev=8,e.t0=e.catch(0),r._lock();case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))),_()(l()(r),"saveKeygenResult",function(){var e=o()(a.a.mark((function e(t){var n,o,s,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.UCPubKey,o=t.OurPubKey,s=t.Sid,i=t.address,c=t.accessToken,t.PVEncStr,0,e.abrupt("return",r.accountRestApi.saveKeyGenResult({uCPubKey:n,pubKey:o,sid:s,address:i,accessToken:c,accountId:0}));case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()),_()(l()(r),"initializeWallet",o()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.dekeyStore.updateStore({unapprovedPersonalMsgs:{}});case 1:case"end":return e.stop()}}),e)})))),_()(l()(r),"unlock",function(){var e=o()(a.a.mark((function e(t,n){var o,s,i,c,u,d,p,l,m,h,f,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.dekeyStore.getState(),s=o.user,i=o.encpv,c=o.wallets,u=D.a.getActiveAccount(s.accounts),d=z.getWallet(c),e.next=5,r.accountRestApi.getChallengeMessage(u.sid);case 5:return p=e.sent,l=p.hashMessage,e.next=9,n.unlock({hashMessage:l,EncPV:i,password:t});case 9:return m=e.sent,h=m.SigR,f=m.SigS,e.next=14,r.accountRestApi.unlock({r:h,s:f,hashMessage:l,aaid:u.id,sid:u.sid,wid:d.wid});case 14:v=e.sent,r.dekeyStore.updateStore({locked:!1,accessToken:v.accessToken,expirationTime:(new Date).getTime()+ +v.expiresIn}),r._setAutologinTimer(v.expiresIn);case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),_()(l()(r),"_setAutologinTimer",(function(e){r._autologinTimeout&&clearTimeout(r._autologinTimeout);var t=setTimeout((function(){return r._autoLogin()}),.7*+e);r._autologinTimeout=t})),_()(l()(r),"_autoLogin",o()(a.a.mark((function e(){var t,n,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.dekeyStore.getState(),n=t.accessToken,e.next=4,r.accountRestApi.getNewSessionJwt(n);case 4:o=e.sent,r.dekeyStore.updateStore({accessToken:o.accessToken,expirationTime:(new Date).getTime()+ +o.expiresIn}),r._setAutologinTimer(o.expiresIn),e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(0),e.next=13,r._lock();case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,9]])})))),_()(l()(r),"_lock",o()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{r.dekeyStore.updateStore({accessToken:null,locked:!0}),r._autologinTimeout&&clearTimeout(r._autologinTimeout)}catch(e){}case 1:case"end":return e.stop()}}),e)})))),r.accountRestApi=s,r.dekeyStore=i,r}return c()(n)}(J.a),Y=n(281),Z=n.n(Y),$=function(){function e(t){var n=this;d()(this,e),_()(this,"worker",void 0),_()(this,"kgEE",void 0),_()(this,"sgEE",void 0),_()(this,"selfSignEE",void 0),_()(this,"showMnemonicEE",void 0),_()(this,"recoverEE",void 0),_()(this,"recoverSIDEE",void 0),_()(this,"sendCipherEE",void 0),_()(this,"emRecoverEE",void 0),this.worker=new Z.a,this.worker.onmessage=function(e){"wasm:loaded"===e.data.eventType&&t.emit("wasm:loaded",{}),"kg"===e.data.eventType&&e.data.done&&n.kgEE.emit("end",e.data.result),"sg"===e.data.eventType&&e.data.done&&n.sgEE.emit("end",e.data.result),"self-sign"===e.data.eventType&&e.data.done&&n.selfSignEE.emit("end",e.data.result),"show-mnemonic"===e.data.eventType&&e.data.done&&n.showMnemonicEE.emit("end",e.data.result),"recover"===e.data.eventType&&e.data.done&&n.recoverEE.emit("end",e.data.result),"recover-sid"===e.data.eventType&&e.data.done&&n.recoverSIDEE.emit("end",e.data.result),"send-cipher"===e.data.eventType&&n.sendCipherEE.emit("end",e.data.result),"em-recover"===e.data.eventType&&n.emRecoverEE.emit("end",e.data.result),"unlock"===e.data.eventType&&n.emRecoverEE.emit("end",e.data.result),"addAccount"===e.data.eventType&&n.emRecoverEE.emit("end",e.data.result),"changeActiveAccount"===e.data.eventType&&n.emRecoverEE.emit("end",e.data.result),"checkPassword"===e.data.eventType&&n.emRecoverEE.emit("end",e.data.result),"changePassword"===e.data.eventType&&n.emRecoverEE.emit("end",e.data.result)},this.worker.postMessage({eventType:"init",data:"go-wasm"})}return c()(e,[{key:"terminate",value:function(){try{this.worker.terminate()}catch(e){}}},{key:"generateKeyShare",value:function(e,t){try{this.kgEE=t,this.worker.postMessage({eventType:"kg",dto:e})}catch(e){}}},{key:"sign",value:function(e,t){this.sgEE=t,this.worker.postMessage({eventType:"sg",arg:e})}},{key:"selfSign",value:function(e,t){this.selfSignEE=t;e.password,e.EncPV,e.hashMessage;this.worker.postMessage({eventType:"self-sign",arg:e})}},{key:"showMnemonic",value:function(e,t){this.showMnemonicEE=t,this.worker.postMessage({eventType:"show-mnemonic"})}},{key:"recoverShare",value:function(e,t){this.recoverEE=t,this.worker.postMessage({eventType:"recover",dto:e})}},{key:"recoverSID",value:function(e,t){this.recoverSIDEE=t,this.worker.postMessage({eventType:"recover-sid",dto:e})}},{key:"sendCipher",value:function(e,t){this.sendCipherEE=t,this.worker.postMessage({eventType:"send-cipher",dto:e})}},{key:"emRecover",value:function(e,t){this.emRecoverEE=t,this.worker.postMessage({eventType:"em-recover",dto:e})}},{key:"addAccount",value:function(e,t){this.emRecoverEE=t,this.worker.postMessage({eventType:"addAccount",dto:e})}},{key:"changeActiveAccount",value:function(e,t){this.emRecoverEE=t,this.worker.postMessage({eventType:"changeActiveAccount",dto:e})}},{key:"unlock",value:function(e,t){this.emRecoverEE=t,this.worker.postMessage({eventType:"unlock",dto:e})}},{key:"checkPassword",value:function(e,t){this.emRecoverEE=t,this.worker.postMessage({eventType:"checkPassword",dto:e})}},{key:"changePassword",value:function(e,t){this.emRecoverEE=t,this.worker.postMessage({eventType:"changePassword",dto:e})}}]),e}();function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var o=b()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v()(this,n)}}var ee=function(e){h()(n,e);var t=Q(n);function n(){var e;return d()(this,n),(e=t.call(this)).wasmEE=new J.a,e.uCWasm=new $(e.wasmEE),e.wasmEE.on("wasm:loaded",(function(t){e.emit("wasm:loaded")})),e}return c()(n,[{key:"generateKeyShare",value:function(e){var t=this;return new Promise((function(n,r){var o=new J.a;o.once("end",(function(e){e.success?n(e.data):r(e.message)})),t.uCWasm.generateKeyShare(e,o)}))}},{key:"sign",value:function(e){var t=this;return new Promise((function(n,r){var o=new J.a;o.once("end",(function(e){e.success?n(e.data):r(e.message)})),t.uCWasm.sign(e,o)}))}},{key:"recoverShare",value:function(e){var t=this;return new Promise((function(n,r){var o=new J.a;o.once("end",(function(e){e.success?n(e.data):r(e.message)})),t.uCWasm.recoverShare(e,o)}))}},{key:"unlock",value:function(e){var t=this;return new Promise((function(n,r){var o=new J.a;o.once("end",(function(e){e.success?n(e.data):r(e.message)})),t.uCWasm.unlock(e,o)}))}},{key:"changePassword",value:function(e){var t=this;return new Promise((function(n,r){var o=new J.a;o.once("end",(function(e){e.success?n(e.data):r(e.message)})),t.uCWasm.changePassword(e,o)}))}}]),n}(J.a),te=n(282),ne=n(285),re=n.n(ne);function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=function(){function e(){d()(this,e)}return c()(e,[{key:"reset",value:function(){localStorage.removeItem("dekey")}},{key:"getState",value:function(){try{var e,t=localStorage.getItem("dekey");return null!==(e=JSON.parse(t))&&void 0!==e?e:{}}catch(e){return{}}}},{key:"updateStore",value:function(e){var t={};try{t=JSON.parse(localStorage.getItem("dekey"))}catch(e){}var n=se(se({},t),e);localStorage.setItem("dekey",JSON.stringify(n))}}]),e}(),ie=["method","data","token","headers"];function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var de="".concat({MANPATH:"/opt/homebrew/share/man:/opt/homebrew/share/man:/usr/share/man:/usr/local/share/man:/opt/homebrew/share/man::",TERM_PROGRAM:"vscode",NODE:"/opt/homebrew/Cellar/node/18.2.0/bin/node",NVM_CD_FLAGS:"-q",INIT_CWD:"/Users/imchangsu/Documents/web-embedded-wallet",TERM:"xterm-256color",SHELL:"/bin/zsh",HOMEBREW_REPOSITORY:"/opt/homebrew",TMPDIR:"/var/folders/gz/3xhfnln95ps4d_bt5z3k_g7r0000gn/T/",npm_config_metrics_registry:"https://registry.npmjs.org/",npm_config_global_prefix:"/opt/homebrew",TERM_PROGRAM_VERSION:"1.67.2",ANDROID_SDK_ROOT:"/Users/imchangsu/Library/Android/sdk",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",TERM_SESSION_ID:"A081A6F8-0D56-483A-82BE-6DF0140771A0",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/imchangsu/Documents/web-embedded-wallet",NVM_DIR:"/Users/imchangsu/.nvm",USER:"imchangsu",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/opt/homebrew/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.SW6CK9NuIb/Listeners",__CF_USER_TEXT_ENCODING:"0x1F5:0x3:0x33",npm_execpath:"/opt/homebrew/lib/node_modules/npm/bin/npx-cli.js",PATH:"/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin:/Users/imchangsu/Documents/node_modules/.bin:/Users/imchangsu/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/opt/homebrew/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin:/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin:/Users/imchangsu/Documents/node_modules/.bin:/Users/imchangsu/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/opt/homebrew/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/opt/homebrew/bin:/opt/homebrew/sbin:/opt/homebrew/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/go/bin:/Library/Apple/usr/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/Library/Java/JavaVirtualMachines/azul-11.0.13/Contents/Home/bin:/Users/imchangsu/Library/Android/sdk/emulator:/Users/imchangsu/Library/Android/sdk/tools:/Users/imchangsu/Library/Android/sdk/tools/bin:/Users/imchangsu/Library/Android/sdk/platform-tools:/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home/bin:/Library/Java/JavaVirtualMachines/azul-11.0.13/Contents/Home/bin:/Users/imchangsu/Library/Android/sdk/emulator:/Users/imchangsu/Library/Android/sdk/tools:/Users/imchangsu/Library/Android/sdk/tools/bin:/Users/imchangsu/Library/Android/sdk/platform-tools:/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home/bin",_:"/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin/webpack",npm_package_json:"/Users/imchangsu/Documents/web-embedded-wallet/package.json",__CFBundleIdentifier:"com.microsoft.VSCode",npm_config_init_module:"/Users/imchangsu/.npm-init.js",npm_config_userconfig:"/Users/imchangsu/.npmrc",PWD:"/Users/imchangsu/Documents/web-embedded-wallet",npm_command:"exec",JAVA_HOME:"/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home",EDITOR:"vi",npm_lifecycle_event:"npx",LANG:"ko_KR.UTF-8",npm_package_name:"dekey-web-embedded-wallet",XPC_FLAGS:"0x0",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"--ms-enable-electron-run-as-node",npm_config_node_gyp:"/opt/homebrew/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",XPC_SERVICE_NAME:"0",npm_package_version:"0.1.4",SHLVL:"5",HOME:"/Users/imchangsu",APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL:"true",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",HOMEBREW_PREFIX:"/opt/homebrew",LOGNAME:"imchangsu",npm_config_cache:"/Users/imchangsu/.npm",npm_lifecycle_script:"webpack",VSCODE_GIT_IPC_HANDLE:"/var/folders/gz/3xhfnln95ps4d_bt5z3k_g7r0000gn/T/vscode-git-bef6cefeaf.sock",npm_config_user_agent:"npm/8.9.0 node/v18.2.0 darwin arm64 workspaces/false",INFOPATH:"/opt/homebrew/share/info:/opt/homebrew/share/info:/opt/homebrew/share/info:/opt/homebrew/share/info:",HOMEBREW_CELLAR:"/opt/homebrew/Cellar",VSCODE_GIT_ASKPASS_NODE:"/Applications/Visual Studio Code.app/Contents/MacOS/Electron",GIT_ASKPASS:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",COLORTERM:"truecolor",npm_config_prefix:"/opt/homebrew",npm_node_execpath:"/opt/homebrew/Cellar/node/18.2.0/bin/node"}.APP_SERVER_ADDRESS_PROTOCOL,"://").concat({MANPATH:"/opt/homebrew/share/man:/opt/homebrew/share/man:/usr/share/man:/usr/local/share/man:/opt/homebrew/share/man::",TERM_PROGRAM:"vscode",NODE:"/opt/homebrew/Cellar/node/18.2.0/bin/node",NVM_CD_FLAGS:"-q",INIT_CWD:"/Users/imchangsu/Documents/web-embedded-wallet",TERM:"xterm-256color",SHELL:"/bin/zsh",HOMEBREW_REPOSITORY:"/opt/homebrew",TMPDIR:"/var/folders/gz/3xhfnln95ps4d_bt5z3k_g7r0000gn/T/",npm_config_metrics_registry:"https://registry.npmjs.org/",npm_config_global_prefix:"/opt/homebrew",TERM_PROGRAM_VERSION:"1.67.2",ANDROID_SDK_ROOT:"/Users/imchangsu/Library/Android/sdk",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",TERM_SESSION_ID:"A081A6F8-0D56-483A-82BE-6DF0140771A0",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/imchangsu/Documents/web-embedded-wallet",NVM_DIR:"/Users/imchangsu/.nvm",USER:"imchangsu",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/opt/homebrew/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.SW6CK9NuIb/Listeners",__CF_USER_TEXT_ENCODING:"0x1F5:0x3:0x33",npm_execpath:"/opt/homebrew/lib/node_modules/npm/bin/npx-cli.js",PATH:"/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin:/Users/imchangsu/Documents/node_modules/.bin:/Users/imchangsu/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/opt/homebrew/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin:/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin:/Users/imchangsu/Documents/node_modules/.bin:/Users/imchangsu/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/opt/homebrew/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/opt/homebrew/bin:/opt/homebrew/sbin:/opt/homebrew/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/go/bin:/Library/Apple/usr/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/Library/Java/JavaVirtualMachines/azul-11.0.13/Contents/Home/bin:/Users/imchangsu/Library/Android/sdk/emulator:/Users/imchangsu/Library/Android/sdk/tools:/Users/imchangsu/Library/Android/sdk/tools/bin:/Users/imchangsu/Library/Android/sdk/platform-tools:/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home/bin:/Library/Java/JavaVirtualMachines/azul-11.0.13/Contents/Home/bin:/Users/imchangsu/Library/Android/sdk/emulator:/Users/imchangsu/Library/Android/sdk/tools:/Users/imchangsu/Library/Android/sdk/tools/bin:/Users/imchangsu/Library/Android/sdk/platform-tools:/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home/bin",_:"/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin/webpack",npm_package_json:"/Users/imchangsu/Documents/web-embedded-wallet/package.json",__CFBundleIdentifier:"com.microsoft.VSCode",npm_config_init_module:"/Users/imchangsu/.npm-init.js",npm_config_userconfig:"/Users/imchangsu/.npmrc",PWD:"/Users/imchangsu/Documents/web-embedded-wallet",npm_command:"exec",JAVA_HOME:"/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home",EDITOR:"vi",npm_lifecycle_event:"npx",LANG:"ko_KR.UTF-8",npm_package_name:"dekey-web-embedded-wallet",XPC_FLAGS:"0x0",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"--ms-enable-electron-run-as-node",npm_config_node_gyp:"/opt/homebrew/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",XPC_SERVICE_NAME:"0",npm_package_version:"0.1.4",SHLVL:"5",HOME:"/Users/imchangsu",APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL:"true",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",HOMEBREW_PREFIX:"/opt/homebrew",LOGNAME:"imchangsu",npm_config_cache:"/Users/imchangsu/.npm",npm_lifecycle_script:"webpack",VSCODE_GIT_IPC_HANDLE:"/var/folders/gz/3xhfnln95ps4d_bt5z3k_g7r0000gn/T/vscode-git-bef6cefeaf.sock",npm_config_user_agent:"npm/8.9.0 node/v18.2.0 darwin arm64 workspaces/false",INFOPATH:"/opt/homebrew/share/info:/opt/homebrew/share/info:/opt/homebrew/share/info:/opt/homebrew/share/info:",HOMEBREW_CELLAR:"/opt/homebrew/Cellar",VSCODE_GIT_ASKPASS_NODE:"/Applications/Visual Studio Code.app/Contents/MacOS/Electron",GIT_ASKPASS:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",COLORTERM:"truecolor",npm_config_prefix:"/opt/homebrew",npm_node_execpath:"/opt/homebrew/Cellar/node/18.2.0/bin/node"}.APP_SERVER_ADDRESS,"/api"),pe=new ae;function le(e){return me.apply(this,arguments)}function me(){return(me=o()(a.a.mark((function e(t){var n,r,s,i,c,u,d=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:{},n.method,r=n.data,s=n.token,i=n.headers,c=re()(n,ie),u=ue({method:r?"POST":"GET",body:r?JSON.stringify(r):void 0,headers:ue({Authorization:s?"Bearer "+s:void 0,"Content-Type":r?"application/json":void 0},i)},c),e.abrupt("return",window.fetch("".concat(de,"/").concat(t),u).then(function(){var e=o()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==t.status){e.next=4;break}return he(),window.location.assign(window.location),e.abrupt("return",Promise.reject({message:"Please re-authenticate."}));case 4:return e.next=6,t.json();case 6:if(n=e.sent,!t.ok){e.next=11;break}return e.abrupt("return",n);case 11:return e.abrupt("return",Promise.reject(n));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(){pe.updateStore({locked:!0,accessToken:null})}var fe=c()((function e(){d()(this,e),_()(this,"registerUser",function(){var e=o()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("registerUser rest api",t),e.prev=1,e.next=4,le("v1/user/register",{data:t});case 4:return n=e.sent,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(1),e.t0;case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()),_()(this,"recoverWallet",function(){var e=o()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,le("v1/user/recover",{data:t});case 3:return n=e.sent,e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),_()(this,"getUser",function(){var e=o()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,le("v1/user/get",{data:{},token:t});case 3:return n=e.sent,e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),_()(this,"getNewSessionJwt",function(){var e=o()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,le("v1/user/accessToken/regen",{data:{},token:t});case 3:return n=e.sent,e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),_()(this,"getChallengeMessage",function(){var e=o()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,le("v1/user/challenge-message",{data:{sid:t}});case 3:return n=e.sent,e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),_()(this,"unlock",function(){var e=o()(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,le("v1/user/unlock",{data:t});case 3:return r=e.sent,e.abrupt("return",r);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}()),_()(this,"getMpcJwt",function(){var e=o()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,le("v1/address/auth/gen",{data:{},token:t});case 3:return n=e.sent,e.abrupt("return",n.mpcJwt);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())})),ve=n(286),ge=n.n(ve),be=n(57),we=n(26),_e=n(287),ye=n.n(_e),ke=n(152),Se=n(288);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Oe={pollingInterval:1e4};function Ae(e){return function(t,n,r,o){return"eth_chainId"===t.method?(n.result=e,o()):r()}}function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var o=b()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v()(this,n)}}var Te=function(e){h()(u,e);var t,n,r,s,i=Pe(u);function u(){var e;d()(this,u);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=i.call.apply(i,[this].concat(n)),_()(l()(e),"connection",void 0),_()(l()(e),"query",void 0),_()(l()(e),"ethQuery",void 0),_()(l()(e),"ethersProvider",void 0),_()(l()(e),"dekeyStore",void 0),_()(l()(e),"connected",void 0),_()(l()(e),"web3",void 0),_()(l()(e),"chainId",void 0),_()(l()(e),"_providerProxy",void 0),_()(l()(e),"_blockTrackerProxy",void 0),_()(l()(e),"_provider",void 0),_()(l()(e),"_blockTracker",void 0),e}return c()(u,[{key:"getProviderAndBlockTracker",value:function(){return{provider:this._providerProxy,blockTracker:this._blockTrackerProxy}}},{key:"connect",value:(s=o()(a.a.mark((function e(t,n){var r,o,s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=t.chainId,o=t.rpcUrl,t.target,t.isCustom,s=o.replace(/\/$/,""),i=o.includes("infura")?s+"/".concat({MANPATH:"/opt/homebrew/share/man:/opt/homebrew/share/man:/usr/share/man:/usr/local/share/man:/opt/homebrew/share/man::",TERM_PROGRAM:"vscode",NODE:"/opt/homebrew/Cellar/node/18.2.0/bin/node",NVM_CD_FLAGS:"-q",INIT_CWD:"/Users/imchangsu/Documents/web-embedded-wallet",TERM:"xterm-256color",SHELL:"/bin/zsh",HOMEBREW_REPOSITORY:"/opt/homebrew",TMPDIR:"/var/folders/gz/3xhfnln95ps4d_bt5z3k_g7r0000gn/T/",npm_config_metrics_registry:"https://registry.npmjs.org/",npm_config_global_prefix:"/opt/homebrew",TERM_PROGRAM_VERSION:"1.67.2",ANDROID_SDK_ROOT:"/Users/imchangsu/Library/Android/sdk",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",TERM_SESSION_ID:"A081A6F8-0D56-483A-82BE-6DF0140771A0",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/imchangsu/Documents/web-embedded-wallet",NVM_DIR:"/Users/imchangsu/.nvm",USER:"imchangsu",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/opt/homebrew/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.SW6CK9NuIb/Listeners",__CF_USER_TEXT_ENCODING:"0x1F5:0x3:0x33",npm_execpath:"/opt/homebrew/lib/node_modules/npm/bin/npx-cli.js",PATH:"/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin:/Users/imchangsu/Documents/node_modules/.bin:/Users/imchangsu/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/opt/homebrew/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin:/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin:/Users/imchangsu/Documents/node_modules/.bin:/Users/imchangsu/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/opt/homebrew/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/opt/homebrew/bin:/opt/homebrew/sbin:/opt/homebrew/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/go/bin:/Library/Apple/usr/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/Library/Java/JavaVirtualMachines/azul-11.0.13/Contents/Home/bin:/Users/imchangsu/Library/Android/sdk/emulator:/Users/imchangsu/Library/Android/sdk/tools:/Users/imchangsu/Library/Android/sdk/tools/bin:/Users/imchangsu/Library/Android/sdk/platform-tools:/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home/bin:/Library/Java/JavaVirtualMachines/azul-11.0.13/Contents/Home/bin:/Users/imchangsu/Library/Android/sdk/emulator:/Users/imchangsu/Library/Android/sdk/tools:/Users/imchangsu/Library/Android/sdk/tools/bin:/Users/imchangsu/Library/Android/sdk/platform-tools:/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home/bin",_:"/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin/webpack",npm_package_json:"/Users/imchangsu/Documents/web-embedded-wallet/package.json",__CFBundleIdentifier:"com.microsoft.VSCode",npm_config_init_module:"/Users/imchangsu/.npm-init.js",npm_config_userconfig:"/Users/imchangsu/.npmrc",PWD:"/Users/imchangsu/Documents/web-embedded-wallet",npm_command:"exec",JAVA_HOME:"/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home",EDITOR:"vi",npm_lifecycle_event:"npx",LANG:"ko_KR.UTF-8",npm_package_name:"dekey-web-embedded-wallet",XPC_FLAGS:"0x0",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"--ms-enable-electron-run-as-node",npm_config_node_gyp:"/opt/homebrew/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",XPC_SERVICE_NAME:"0",npm_package_version:"0.1.4",SHLVL:"5",HOME:"/Users/imchangsu",APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL:"true",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",HOMEBREW_PREFIX:"/opt/homebrew",LOGNAME:"imchangsu",npm_config_cache:"/Users/imchangsu/.npm",npm_lifecycle_script:"webpack",VSCODE_GIT_IPC_HANDLE:"/var/folders/gz/3xhfnln95ps4d_bt5z3k_g7r0000gn/T/vscode-git-bef6cefeaf.sock",npm_config_user_agent:"npm/8.9.0 node/v18.2.0 darwin arm64 workspaces/false",INFOPATH:"/opt/homebrew/share/info:/opt/homebrew/share/info:/opt/homebrew/share/info:/opt/homebrew/share/info:",HOMEBREW_CELLAR:"/opt/homebrew/Cellar",VSCODE_GIT_ASKPASS_NODE:"/Applications/Visual Studio Code.app/Contents/MacOS/Electron",GIT_ASKPASS:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",COLORTERM:"truecolor",npm_config_prefix:"/opt/homebrew",npm_node_execpath:"/opt/homebrew/Cellar/node/18.2.0/bin/node"}.INFURA_ID):o.includes("alchemy")?s+"/".concat({MANPATH:"/opt/homebrew/share/man:/opt/homebrew/share/man:/usr/share/man:/usr/local/share/man:/opt/homebrew/share/man::",TERM_PROGRAM:"vscode",NODE:"/opt/homebrew/Cellar/node/18.2.0/bin/node",NVM_CD_FLAGS:"-q",INIT_CWD:"/Users/imchangsu/Documents/web-embedded-wallet",TERM:"xterm-256color",SHELL:"/bin/zsh",HOMEBREW_REPOSITORY:"/opt/homebrew",TMPDIR:"/var/folders/gz/3xhfnln95ps4d_bt5z3k_g7r0000gn/T/",npm_config_metrics_registry:"https://registry.npmjs.org/",npm_config_global_prefix:"/opt/homebrew",TERM_PROGRAM_VERSION:"1.67.2",ANDROID_SDK_ROOT:"/Users/imchangsu/Library/Android/sdk",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",TERM_SESSION_ID:"A081A6F8-0D56-483A-82BE-6DF0140771A0",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/imchangsu/Documents/web-embedded-wallet",NVM_DIR:"/Users/imchangsu/.nvm",USER:"imchangsu",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/opt/homebrew/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.SW6CK9NuIb/Listeners",__CF_USER_TEXT_ENCODING:"0x1F5:0x3:0x33",npm_execpath:"/opt/homebrew/lib/node_modules/npm/bin/npx-cli.js",PATH:"/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin:/Users/imchangsu/Documents/node_modules/.bin:/Users/imchangsu/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/opt/homebrew/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin:/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin:/Users/imchangsu/Documents/node_modules/.bin:/Users/imchangsu/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/opt/homebrew/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/opt/homebrew/bin:/opt/homebrew/sbin:/opt/homebrew/bin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/go/bin:/Library/Apple/usr/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Library/Frameworks/Python.framework/Versions/3.9/bin:/Library/Java/JavaVirtualMachines/azul-11.0.13/Contents/Home/bin:/Users/imchangsu/Library/Android/sdk/emulator:/Users/imchangsu/Library/Android/sdk/tools:/Users/imchangsu/Library/Android/sdk/tools/bin:/Users/imchangsu/Library/Android/sdk/platform-tools:/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home/bin:/Library/Java/JavaVirtualMachines/azul-11.0.13/Contents/Home/bin:/Users/imchangsu/Library/Android/sdk/emulator:/Users/imchangsu/Library/Android/sdk/tools:/Users/imchangsu/Library/Android/sdk/tools/bin:/Users/imchangsu/Library/Android/sdk/platform-tools:/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home/bin",_:"/Users/imchangsu/Documents/web-embedded-wallet/node_modules/.bin/webpack",npm_package_json:"/Users/imchangsu/Documents/web-embedded-wallet/package.json",__CFBundleIdentifier:"com.microsoft.VSCode",npm_config_init_module:"/Users/imchangsu/.npm-init.js",npm_config_userconfig:"/Users/imchangsu/.npmrc",PWD:"/Users/imchangsu/Documents/web-embedded-wallet",npm_command:"exec",JAVA_HOME:"/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home",EDITOR:"vi",npm_lifecycle_event:"npx",LANG:"ko_KR.UTF-8",npm_package_name:"dekey-web-embedded-wallet",XPC_FLAGS:"0x0",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"--ms-enable-electron-run-as-node",npm_config_node_gyp:"/opt/homebrew/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",XPC_SERVICE_NAME:"0",npm_package_version:"0.1.4",SHLVL:"5",HOME:"/Users/imchangsu",APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL:"true",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",HOMEBREW_PREFIX:"/opt/homebrew",LOGNAME:"imchangsu",npm_config_cache:"/Users/imchangsu/.npm",npm_lifecycle_script:"webpack",VSCODE_GIT_IPC_HANDLE:"/var/folders/gz/3xhfnln95ps4d_bt5z3k_g7r0000gn/T/vscode-git-bef6cefeaf.sock",npm_config_user_agent:"npm/8.9.0 node/v18.2.0 darwin arm64 workspaces/false",INFOPATH:"/opt/homebrew/share/info:/opt/homebrew/share/info:/opt/homebrew/share/info:/opt/homebrew/share/info:",HOMEBREW_CELLAR:"/opt/homebrew/Cellar",VSCODE_GIT_ASKPASS_NODE:"/Applications/Visual Studio Code.app/Contents/MacOS/Electron",GIT_ASKPASS:"/Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",COLORTERM:"truecolor",npm_config_prefix:"/opt/homebrew",npm_node_execpath:"/opt/homebrew/Cellar/node/18.2.0/bin/node"}.ALCHEMY_ID):s,this._initialize({rpcUrl:i,chainId:r}),this.web3=new ge.a(this._provider),this.ethersProvider=new be.a.providers.Web3Provider(this._provider),this.query=new ye.a(this._provider),this.chainId=t.chainId,e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e,t){return s.apply(this,arguments)})},{key:"_initialize",value:function(e){var t=function(e){var t=e.rpcUrl,n=e.chainId,r=Object(E.createFetchMiddleware)({rpcUrl:t}),o=Object(E.providerFromMiddleware)(r),s=new Se.PollingBlockTracker(xe(xe({},Oe),{},{provider:o}));return{networkMiddleware:Object(S.mergeMiddleware)([Ae(n),r]),blockTracker:s}}({rpcUrl:e.rpcUrl,chainId:e.chainId,networkDomain:e.networkDomain});this._setNetworkClient(t)}},{key:"_setNetworkClient",value:function(e){var t=e.networkMiddleware,n=e.blockTracker,r=new S.JsonRpcEngine;r.push(t);var o=Object(E.providerFromEngine)(r);this._setProviderAndBlockTracker({provider:o,blockTracker:n})}},{key:"_setProviderAndBlockTracker",value:function(e){var t=e.provider,n=e.blockTracker;this._providerProxy?this._providerProxy.setTarget(t):this._providerProxy=Object(ke.createSwappableProxy)(t),this._blockTrackerProxy?this._blockTrackerProxy.setTarget(n):this._blockTrackerProxy=Object(ke.createEventEmitterProxy)(n,{eventFilter:"skipInternal"}),this._provider=t,this._blockTracker=n}},{key:"getTransactionCount",value:(r=o()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query.getTransactionCount(t,"pending");case 2:return n=e.sent,e.abrupt("return",we.a.from(n.toString(10)).toHexString());case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"broadcastTx",value:(n=o()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query.sendRawTransaction(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"estimateGas",value:(t=o()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query.estimateGas(t);case 2:return n=e.sent,e.abrupt("return",we.a.from(n.toString(10)).toHexString());case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),u}(J.a),Me=[{symbol:"ETH",name:"Private Network",rpcUrl:"https://ethereum.myinitial.io",chainId:6888,blockExplorerUrl:"http://54.180.149.196/?rpcUrl=http://54.180.149.196:8668"}],Re={getCurrentNetwork:function(){return Me[0]}};function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ue=function(){function e(t){var n=t.transactionService,r=t.providerConnectionManager,o=t.dekeyStore;d()(this,e),this.transactionService=n,this.providerConnectionManager=r,this.dekeyStore=o}var t;return c()(e,[{key:"ethSendTransaction",value:(t=o()(a.a.mark((function e(t){var n,r,o,s,i,c,u,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("ethSendTransaction newTxParams",t),r=this.dekeyStore.getState(),o=r.user,console.log("ethSendTransaction user",o),s=D.a.getActiveAccount(o.accounts),i=Re.getCurrentNetwork(),e.next=7,this.providerConnectionManager.getTransactionCount(s.ethAddress);case 7:return c=e.sent,console.log("networkNonceNext",c),e.next=11,this.providerConnectionManager.estimateGas({from:s.ethAddress,to:t.to,data:t.data,value:null!==(n=t.value)&&void 0!==n?n:"0x0"});case 11:return u=e.sent,console.log("gas",u),e.next=15,this.transactionService.signTx({txParams:De({chainId:i.chainId,from:s.ethAddress,gasLimit:u},t),nonce:c,network:i,account:s});case 15:return d=e.sent,e.abrupt("return",this.providerConnectionManager.broadcastTx(d));case 17:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),Ie=function(){function e(t){var n=t.accountService,r=t.mpcService,o=t.dekeyStore,s=t.accountRestApi;d()(this,e),this.accountService=n,this.mpcService=r,this.dekeyStore=o,this.accountRestApi=s}var t,n,r,s,i;return c()(e,[{key:"generateKey",value:(i=o()(a.a.mark((function e(t){var n,r,o,s,i,c,u,d,p,l,m;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.password,r=(new Date).getTime(),o=1,e.next=6,this.mpcService.generateKeyShare({uid:r,wid:o,password:n,mpcToken:"DUMMY_TOKEN"});case 6:return s=e.sent,console.log("keyGenResult",s),i=s.UCPubKey,c=s.OurPubKey,u=s.Sid,d=s.PVEncStr,e.next=11,this.accountService.registerUser({address:u,pubkey:c,uCPubKey:i,sid:u,uid:r,wid:o});case 11:return p=e.sent,l=p.user,m=p.wallets,console.log("updatedUser",l),this.dekeyStore.updateStore({user:l,wallets:m,encpv:d}),e.next=18,this.unlock({password:n});case 18:return e.abrupt("return",{user:l,wallets:m,encpv:d});case 19:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"recoverShare",value:(s=o()(a.a.mark((function e(t){var n,r,o,s,i,c,u,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("recoverShare user",t),n=t.password,r=t.user,o=t.wallets,s=z.getNextWidForRecover(o),e.next=6,this.mpcService.recoverShare({uid:+r.uid,wid:s,password:n,sid:r.accounts[0].sid,mpcToken:"DUMMY_TOKEN"});case 6:return i=e.sent,c=i.UCPubKey,i.OurPubKey,i.Sid,u=i.PVEncStr,e.next=13,this.accountService.recoverWallet({uid:+r.uid,wid:s,uCPubKey:c});case 13:return d=e.sent,this.dekeyStore.updateStore({user:r,wallets:d.wallets,encpv:u}),e.next=17,this.unlock({password:n});case 17:return e.abrupt("return",{user:r,wallets:d.wallets,encpv:u});case 18:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"unlock",value:(r=o()(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.password,e.prev=1,e.next=4,this.accountService.unlock(n,this.mpcService);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),e.t0;case 9:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(e){return r.apply(this,arguments)})},{key:"getUser",value:(n=o()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.accountService.getUser());case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"changePassword",value:(t=o()(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mpcService.changePassword(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),Le=n(289);o()(a.a.mark((function e(){var t,n,r,s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new ae,n=new fe,r=new q({accountRestApi:n,dekeyStore:t}),s=new ee,i=new te.a({mpcService:s,dekeyStore:t,accountRestApi:n}),s.on("wasm:loaded",o()(a.a.mark((function e(){var o,c,u,d,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.initializeWallet();case 2:return o=Re.getCurrentNetwork(),c=new Te,u=new Ue({transactionService:i,providerConnectionManager:c,dekeyStore:t}),d=new Ie({accountService:r,mpcService:s,dekeyStore:t}),p=new Le.a({mpcService:s,transactionService:i,dekeyStore:t,getMpcJwt:n.getMpcJwt}),e.next=9,c.connect(o);case 9:new G({webview:window,url:window.location.href,isMainFrame:!0,transactionController:u,accountController:d,personalMessageController:p,providerConnectionManager:c,dekeyStore:t});case 10:case"end":return e.stop()}}),e)}))));case 6:case"end":return e.stop()}}),e)})))()}});